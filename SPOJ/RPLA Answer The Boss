//https://github.com/rkas123/TEMPLATE/blob/master/Template.cpp
//Template taken from here

using namespace std;
int main()
{
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    #ifndef ONLINE_JUDGE
      freopen("input.txt", "r", stdin);
      freopen("output.txt", "w", stdout);
    #endif
    KStest()
    {
        in(n);in(m);
        bool vis[n];
        vector<int> adjlist[n];
        int indegree[n];
        for(int i=0;i<n;i++)
        {
            vis[i]=false;
            indegree[i]=0;
        }
        for(int i=0;i<m;i++)
        {
            in(u);in(v);
            adjlist[v].pb(u);
            indegree[u]++;
        }
        queue<int> q;
        for(int i=0;i<n;i++)
        {
            if(indegree[i]==0)
            {
                q.push(i);
            }
        }
        q.push(-1);
        int rank=1;
        map<int,set<int>> ma;
        while(!q.empty())
        {
            int node=q.front();
            q.pop();
            if(node==-1)
            {
                if(!q.empty())
                {
                    q.push(-1);
                }
                rank++;
            }
            else
            {
                vis[node]=true;
                ma[rank].insert(node);
                for(auto it: adjlist[node])
                {
                    indegree[it]--;
                    if(indegree[it]==0)
                        q.push(it);
                }
            }
        }
        KScout;
        cout<<endl;
        for(auto it: ma)
        {
            for(auto i:it.S)
            {
                cout<<it.F<<" "<<i<<endl;
            }
        }
    }
    
    return 0;   
}
